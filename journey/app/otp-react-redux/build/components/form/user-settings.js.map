{"version":3,"sources":["user-settings.js"],"names":["getDetailText","formatStoredPlaceName","matchLatLon","coreUtils","map","summarizeQuery","query","BUTTON_WIDTH","UserSettings","Component","user","toggleTracking","props","trackRecent","hasRecents","recentPlaces","length","recentSearches","window","confirm","locations","find","l","type","push","id","icon","name","blank","render","storageDisclaimer","favoriteStops","_getLocations","order","sortedLocations","sort","a","b","indexOf","padding","location","timestamp","search","_enableTracking","_disableTracking","Place","setLocation","alert","to","from","locationType","setViewedStop","stopId","forgetPlace","forgetStop","showView","_isViewable","showForget","_isForgettable","offset","width","_onSelect","_onView","_onForget","RecentSearch","setQueryParam","forgetSearch","fromNow","whiteSpace","overflow","textOverflow","textAlign","paddingTop","mapStateToProps","state","ownProps","config","otp","currentPosition","nearbyStops","currentQuery","sessionSearches","stopsIndex","transitIndex","stops","language","mapDispatchToProps"],"mappings":"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","sourcesContent":["import moment from 'moment'\nimport coreUtils from '@opentripplanner/core-utils'\nimport React, { Component } from 'react'\nimport { Button } from 'react-bootstrap'\nimport { connect } from 'react-redux'\n\nimport Icon from '../narrative/icon'\nimport { forgetSearch, toggleTracking } from '../../actions/api'\nimport { setQueryParam } from '../../actions/form'\nimport { forgetPlace, forgetStop, setLocation } from '../../actions/map'\nimport { setViewedStop } from '../../actions/ui'\n\nconst { getDetailText, formatStoredPlaceName, matchLatLon } = coreUtils.map\nconst { summarizeQuery } = coreUtils.query\n\nconst BUTTON_WIDTH = 40\n\nclass UserSettings extends Component {\n  _disableTracking = () => {\n    const { user, toggleTracking } = this.props\n    if (!user.trackRecent) return\n    const hasRecents = user.recentPlaces.length > 0 || user.recentSearches.length > 0\n    // If user has recents and does not confirm deletion, return without doing\n    // anything.\n    if (hasRecents && !window.confirm('You have recent searches and/or places stored. Disabling storage of recent places/searches will remove these items. Continue?')) {\n      return\n    }\n    // Disable tracking if we reach this statement.\n    toggleTracking(false)\n  }\n\n  _enableTracking = () => !this.props.user.trackRecent && this.props.toggleTracking(true)\n\n  _getLocations = (user) => {\n    const locations = [...user.locations]\n    if (!locations.find(l => l.type === 'work')) {\n      locations.push({\n        id: 'work',\n        type: 'work',\n        icon: 'briefcase',\n        name: '$_add_$',\n        blank: true\n      })\n    }\n    if (!locations.find(l => l.type === 'home')) {\n      locations.push({\n        id: 'home',\n        type: 'home',\n        icon: 'home',\n        name: '$_add_$',\n        blank: true\n      })\n    }\n    return locations\n  }\n\n  render () {\n    const { storageDisclaimer, user } = this.props\n    const { favoriteStops, trackRecent, recentPlaces, recentSearches } = user\n    // Clone locations in order to prevent blank locations from seeping into the\n    // app state/store.\n    const locations = this._getLocations(user)\n    const order = ['home', 'work', 'suggested', 'stop', 'recent']\n    const sortedLocations = locations\n      .sort((a, b) => order.indexOf(a.type) - order.indexOf(b.type))\n    return (\n      <div className='user-settings'>\n        <ul style={{ padding: 0 }}>\n          {sortedLocations.map(location => {\n            return <Place key={location.id} location={location} {...this.props} />\n          })}\n        </ul>\n        <hr />\n        <div className='section-header'>$_favorite_stops_$</div>\n        <ul style={{ padding: 0 }}>\n          {favoriteStops.length > 0\n            ? favoriteStops.map(location => {\n              return <Place key={location.id} location={location} {...this.props} />\n            })\n            : <small>$_no_favorite_stops_$ </small>\n          }\n        </ul>\n        {trackRecent && recentPlaces.length > 0 &&\n          <div className='recent-places-container'>\n            <hr />\n            <div className='section-header'>Recent places</div>\n            <ul style={{ padding: 0 }}>\n              {recentPlaces.map(location => {\n                return <Place key={location.id} location={location} {...this.props} />\n              })}\n            </ul>\n          </div>\n        }\n        {trackRecent && recentSearches.length > 0 &&\n          <div className='recent-searches-container'>\n            <hr />\n            <div className='section-header'>Recent searches</div>\n            <ul style={{ padding: 0 }}>\n              {recentSearches\n                .sort((a, b) => b.timestamp - a.timestamp)\n                .map(search => {\n                  return <RecentSearch key={search.id} search={search} {...this.props} />\n                })\n              }\n            </ul>\n          </div>\n        }\n        <hr />\n        <div className='remember-settings'>\n          <div className='section-header'>$_my_preferences_$</div>\n          <small>$_save_researches_$</small>\n          <Button\n            onClick={this._enableTracking}\n            className={trackRecent ? 'active' : ''}\n            bsSize='xsmall'\n            bsStyle='link'>Yes</Button>\n          <Button\n            onClick={this._disableTracking}\n            className={!trackRecent ? 'active' : ''}\n            bsSize='xsmall'\n            bsStyle='link'>No</Button>\n        </div>\n        {storageDisclaimer &&\n          <div>\n            <hr />\n            <div className='disclaimer'>\n              {storageDisclaimer}\n            </div>\n          </div>\n        }\n      </div>\n    )\n  }\n}\n\nclass Place extends Component {\n  _onSelect = () => {\n    const { location, query, setLocation } = this.props\n    if (location.blank) {\n      window.alert(`Enter origin/destination in the form (or set via map click) and click the resulting marker to set as ${location.type} location.`)\n    } else {\n      // If 'to' not set and 'from' does not match location, set as 'to'.\n      if (\n        !query.to && (\n          !query.from || !matchLatLon(location, query.from)\n        )\n      ) {\n        setLocation({ locationType: 'to', location })\n      } else if (\n        // Vice versa for setting as 'from'.\n        !query.from &&\n          !matchLatLon(location, query.to)\n      ) {\n        setLocation({ locationType: 'from', location })\n      }\n    }\n  }\n\n  _onView = () => {\n    const { location, setViewedStop } = this.props\n    setViewedStop({ stopId: location.id })\n  }\n\n  _onForget = () => {\n    const { forgetPlace, forgetStop, location } = this.props\n    if (location.type === 'stop') forgetStop(location.id)\n    else forgetPlace(location.id)\n  }\n\n  _isViewable = () => this.props.location.type === 'stop'\n\n  _isForgettable = () =>\n    ['stop', 'home', 'work', 'recent'].indexOf(this.props.location.type) !== -1\n\n  render () {\n    const { location } = this.props\n    const { blank, icon } = location\n    const showView = this._isViewable()\n    const showForget = this._isForgettable() && !blank\n    // Determine how much to offset width of main button (based on visibility of\n    // other buttons sharing the same line).\n    let offset = 0\n    if (showView) offset += BUTTON_WIDTH\n    if (showForget) offset += BUTTON_WIDTH\n    return (\n      <li className='place-item'>\n        <Button\n          bsStyle='link'\n          title={formatStoredPlaceName(location)}\n          className='place-button'\n          style={{ width: `calc(100% - ${offset}px)` }}\n          onClick={this._onSelect}>\n          <span\n            className='place-text'>\n            <Icon type={icon} /> {formatStoredPlaceName(location, false)}\n          </span>\n          <span\n            className='place-detail'>\n            {getDetailText(location)}\n          </span>\n        </Button>\n        {showView &&\n          <Button\n            onClick={this._onView}\n            className='place-view'\n            bsSize='xsmall'\n            title='View stop'\n            style={{ width: `${BUTTON_WIDTH}px` }}\n            bsStyle='link'><Icon type='search' /></Button>\n        }\n        {showForget &&\n          <Button\n            onClick={this._onForget}\n            className='place-clear'\n            bsSize='xsmall'\n            style={{ width: `${BUTTON_WIDTH}px` }}\n            bsStyle='link'>Clear</Button>\n        }\n      </li>\n    )\n  }\n}\n\nclass RecentSearch extends Component {\n  _onSelect = () => {\n    const { search, setQueryParam } = this.props\n    // Update query params and initiate search.\n    setQueryParam(search.query, search.id)\n  }\n\n  _onForget = () => this.props.forgetSearch(this.props.search.id)\n\n  render () {\n    const { search, user } = this.props\n    const { query, timestamp } = search\n    const name = summarizeQuery(query, user.locations)\n    return (\n      <li className='place-item'>\n        <Button\n          bsStyle='link'\n          title={`${name} (${moment(timestamp).fromNow()})`}\n          style={{\n            padding: '5px 0 0 0',\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            textAlign: 'left',\n            width: `calc(100% - ${BUTTON_WIDTH}px)`\n          }}\n          onClick={this._onSelect}>\n          <span className='place-text'><Icon type='clock-o' /> {name} </span>\n          <span className='place-detail'>{moment(timestamp).fromNow()}</span>\n        </Button>\n        <Button\n          onClick={this._onForget}\n          bsSize='xsmall'\n          style={{ paddingTop: '6px', width: `${BUTTON_WIDTH}px` }}\n          bsStyle='link'>Clear</Button>\n      </li>\n    )\n  }\n}\n\n// connect to redux store\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    config: state.otp.config,\n    currentPosition: state.otp.location.currentPosition,\n    nearbyStops: state.otp.location.nearbyStops,\n    query: state.otp.currentQuery,\n    sessionSearches: state.otp.location.sessionSearches,\n    stopsIndex: state.otp.transitIndex.stops,\n    storageDisclaimer: state.otp.config.language.storageDisclaimer,\n    user: state.otp.user\n  }\n}\n\nconst mapDispatchToProps = {\n  forgetStop,\n  forgetPlace,\n  forgetSearch,\n  setLocation,\n  setQueryParam,\n  setViewedStop,\n  toggleTracking\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserSettings)\n"]}