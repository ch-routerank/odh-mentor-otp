{"version":3,"sources":["trip-tools.js"],"names":["TripTools","props","buttonTypes","reportConfig","reactRouterConfig","buttonComponents","forEach","type","push","mailto","startOverUrl","basename","map","btn","i","Component","CopyUrlButton","setState","showCopied","routerId","window","sessionStorage","getItem","url","location","href","parts","split","length","console","warn","setTimeout","_resetState","state","_onClick","PrintButton","printUrl","replace","open","ReportIssueButton","subject","bodyLines","bowser","name","version","osname","osversion","encodeURIComponent","join","LinkButton","icon","text","mapStateToProps","ownProps","otp","config","reportIssue","reactRouter"],"mappings":"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","sourcesContent":["import React, {Component} from 'react'\nimport { connect } from 'react-redux'\nimport { Button } from 'react-bootstrap'\n// import { DropdownButton, MenuItem } from 'react-bootstrap'\nimport copyToClipboard from 'copy-to-clipboard'\nimport bowser from 'bowser'\n\nclass TripTools extends Component {\n  static defaultProps = {\n    buttonTypes: [ 'COPY_URL', 'PRINT', 'REPORT_ISSUE', 'START_OVER' ]\n  }\n\n  render () {\n    const { buttonTypes, reportConfig, reactRouterConfig } = this.props\n\n    const buttonComponents = []\n    buttonTypes.forEach((type) => {\n      switch (type) {\n        case 'COPY_URL':\n          buttonComponents.push(<CopyUrlButton />)\n          break\n        case 'PRINT':\n          buttonComponents.push(<PrintButton />)\n          break\n        case 'REPORT_ISSUE':\n          if (!reportConfig || !reportConfig.mailto) break\n          buttonComponents.push(<ReportIssueButton {...reportConfig} />)\n          break\n        case 'START_OVER':\n          // Determine \"home\" URL\n          let startOverUrl = '/'\n          if (reactRouterConfig && reactRouterConfig.basename) {\n            startOverUrl += reactRouterConfig.basename\n          }\n          buttonComponents.push(<LinkButton icon='undo' text='Ricomincia' url={startOverUrl} />)\n          break\n      }\n    })\n\n    return (\n      <div className='trip-tools'>\n        {buttonComponents.map((btn, i) => <div key={i} className='button-container'>{btn}</div>)}\n      </div>\n    )\n  }\n}\n\n// Share/Save Dropdown Component -- not used currently\n\n/*\nclass ShareSaveDropdownButton extends Component {\n  _onCopyToClipboardClick = () => {\n    copyToClipboard(window.location.href)\n  }\n\n  render () {\n    return (\n      <DropdownButton\n        className='tool-button'\n        title={<span><i className='fa fa-share' /> Share/Save</span>}\n        id={'tool-share-dropdown'}\n      >\n        <MenuItem onClick={this._onCopyToClipboardClick}>\n          <i className='fa fa-clipboard' /> Copy Link to Clipboard\n        </MenuItem>\n      </DropdownButton>\n    )\n  }\n}\n*/\n\n// Copy URL Button\n\nclass CopyUrlButton extends Component {\n  constructor (props) {\n    super(props)\n    this.state = { showCopied: false }\n  }\n\n  _resetState = () => this.setState({ showCopied: false })\n\n  _onClick = () => {\n    // If special routerId has been set in session storage, construct copy URL\n    // for itinerary with #/start/ prefix to set routerId on page load.\n    const routerId = window.sessionStorage.getItem('routerId')\n    let url = window.location.href\n    if (routerId) {\n      const parts = url.split('#')\n      if (parts.length === 2) {\n        url = `${parts[0]}#/start/x/x/x/${routerId}${parts[1]}`\n      } else {\n        console.warn('URL not formatted as expected, copied URL will not contain session routerId.', routerId)\n      }\n    }\n    copyToClipboard(url)\n    this.setState({ showCopied: true })\n    window.setTimeout(this._resetState, 2000)\n  }\n\n  render () {\n    return (\n      <div>\n        <Button\n          className='tool-button'\n          onClick={this._onClick}\n        >\n          {this.state.showCopied\n            ? <span><i className='fa fa-check' /> Copied</span>\n            : <span><i className='fa fa-clipboard' /> Copy Link</span>\n          }\n        </Button>\n      </div>\n    )\n  }\n}\n\n// Print Button Component\n\nclass PrintButton extends Component {\n  _onClick = () => {\n    // Note: this is designed to work only with hash routing.\n    const printUrl = window.location.href.replace('#', '#/print')\n    window.open(printUrl, '_blank')\n  }\n\n  render () {\n    return (\n      <div>\n        <Button\n          className='tool-button'\n          onClick={this._onClick}\n        >\n          <i className='fa fa-print' /> Print\n        </Button>\n      </div>\n    )\n  }\n}\n\n// Report Issue Button Component\n\nclass ReportIssueButton extends Component {\n  static defaultProps = {\n    subject: 'Reporting an Issue with OpenTripPlanner'\n  }\n\n  _onClick = () => {\n    const { mailto, subject } = this.props\n\n    const bodyLines = [\n      '                       *** INSTRUCTIONS TO USER ***',\n      'This feature allows you to email a report to site administrators for review.',\n      `Please add any additional feedback for this trip under the 'Additional Comments'`,\n      'section below and send using your regular email program.',\n      '',\n      'SEARCH DATA:',\n      'Address: ' + window.location.href,\n      'Browser: ' + bowser.name + ' ' + bowser.version,\n      'OS: ' + bowser.osname + ' ' + bowser.osversion,\n      '',\n      'ADDITIONAL COMMENTS:',\n      ''\n    ]\n\n    window.open(`mailto:${mailto}?subject=${subject}&body=${encodeURIComponent(bodyLines.join('\\n'))}`, '_self')\n  }\n\n  render () {\n    return (\n      <Button\n        className='tool-button'\n        onClick={this._onClick}\n      >\n        <i className='fa fa-flag' /> Report Issue\n      </Button>\n    )\n  }\n}\n\n// Link to URL Button\n\nclass LinkButton extends Component {\n  _onClick = () => {\n    window.location.href = this.props.url\n  }\n\n  render () {\n    const { icon, text } = this.props\n    return (\n      <div>\n        <Button\n          className='tool-button'\n          onClick={this._onClick}\n        >\n          {icon && <span><i className={`fa fa-${icon}`} /> </span>}\n          {text}\n        </Button>\n      </div>\n    )\n  }\n}\n\n// Connect main class to redux store\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    reportConfig: state.otp.config.reportIssue,\n    reactRouterConfig: state.otp.config.reactRouter\n  }\n}\n\nexport default connect(mapStateToProps)(TripTools)\n"]}