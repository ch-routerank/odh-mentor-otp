{"version":3,"sources":["trip-viewer.js"],"names":["TripViewer","Component","props","setViewedTrip","componentDidMount","findTrip","viewedTrip","tripId","render","hideBackButton","languageConfig","timeFormat","tripData","_backClicked","tripViewer","clear","route","shortName","longName","wheelchairAccessible","bikesAllowed","stops","stopTimes","map","stop","i","stripMapLineClass","length","highlightClass","fromIndex","toIndex","coreUtils","time","formatSecondsAfterMidnight","scheduledDeparture","id","name","PropTypes","bool","object","mapStateToProps","state","ownProps","otp","ui","config","language","getTimeFormat","transitIndex","trips","mapDispatchToProps","setLocation"],"mappings":"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","sourcesContent":["import coreUtils from '../../otp-ui/core-utils/src'\nimport PropTypes from 'prop-types'\nimport React, { Component } from 'react'\nimport { Button, Label } from 'react-bootstrap'\nimport { connect } from 'react-redux'\n\nimport Icon from '../narrative/icon'\nimport ViewStopButton from './view-stop-button'\n\nimport { setViewedTrip } from '../../actions/ui'\nimport { findTrip } from '../../actions/api'\nimport { setLocation } from '../../actions/map'\n\nclass TripViewer extends Component {\n  static propTypes = {\n    hideBackButton: PropTypes.bool,\n    tripData: PropTypes.object,\n    viewedTrip: PropTypes.object\n  }\n\n  _backClicked = () => {\n    this.props.setViewedTrip(null)\n  }\n\n  componentDidMount () {\n    const { findTrip, viewedTrip } = this.props\n    const { tripId } = viewedTrip\n    findTrip({ tripId })\n  }\n\n  render () {\n    const {\n      hideBackButton,\n      languageConfig,\n      timeFormat,\n      tripData,\n      viewedTrip\n    } = this.props\n\n    return (\n      <div className='trip-viewer'>\n        {/* Header Block */}\n        <div className='trip-viewer-header'>\n          {/* Back button */}\n          {!hideBackButton && (\n            <div className='back-button-container'>\n              <Button\n                bsSize='small'\n                onClick={this._backClicked}\n              ><Icon type='arrow-left' />Back</Button>\n            </div>\n          )}\n\n          {/* Header Text */}\n          <div className='header-text'>\n            {languageConfig.tripViewer || 'Trip Viewer'}\n          </div>\n          <div style={{ clear: 'both' }} />\n        </div>\n\n        <div className='trip-viewer-body'>\n          {/* Basic Trip Info */}\n          {tripData && (\n            <div>\n              {/* Route name */}\n              <div>Route: <b>{tripData.route.shortName}</b> {tripData.route.longName}</div>\n\n              {/* Wheelchair/bike accessibility badges, if applicable */}\n              <h4>\n                {tripData.wheelchairAccessible === 1 &&\n                  <Label bsStyle='primary'>\n                    <Icon type='wheelchair-alt' /> Accessible\n                  </Label>\n                }\n                {' '}\n                {tripData.bikesAllowed === 1 &&\n                  <Label bsStyle='success'>\n                    <Icon type='bicycle' /> Allowed\n                  </Label>\n                }\n              </h4>\n            </div>\n          )}\n\n          {/* Stop Listing */}\n          {tripData && tripData.stops && tripData.stopTimes && (\n            tripData.stops.map((stop, i) => {\n              // determine whether to use special styling for first/last stop\n              let stripMapLineClass = 'strip-map-line'\n              if (i === 0) stripMapLineClass = 'strip-map-line-first'\n              else if (i === tripData.stops.length - 1) stripMapLineClass = 'strip-map-line-last'\n\n              // determine whether to show highlight in strip map\n              let highlightClass\n              if (i === viewedTrip.fromIndex) highlightClass = 'strip-map-highlight-first'\n              else if (i > viewedTrip.fromIndex && i < viewedTrip.toIndex) highlightClass = 'strip-map-highlight'\n              else if (i === viewedTrip.toIndex) highlightClass = 'strip-map-highlight-last'\n\n              return (\n                <div key={i}>\n                  {/* the departure time */}\n                  <div className='stop-time'>\n                    {coreUtils.time.formatSecondsAfterMidnight(tripData.stopTimes[i].scheduledDeparture, timeFormat)}\n                  </div>\n\n                  {/* the vertical strip map */}\n                  <div className='strip-map-container'>\n                    { highlightClass && <div className={highlightClass} /> }\n                    <div className={stripMapLineClass} />\n                    <div className='strip-map-icon'><Icon type='circle' /></div>\n                  </div>\n\n                  {/* the stop-viewer button */}\n                  <div className='stop-button-container'>\n                    <ViewStopButton stopId={stop.id} text='View' />\n                  </div>\n\n                  {/* the main stop label */}\n                  <div className='stop-name'>\n                    {stop.name}\n                  </div>\n\n                  <div style={{ clear: 'both' }} />\n\n                </div>\n              )\n            })\n          )}\n        </div>\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const viewedTrip = state.otp.ui.viewedTrip\n  return {\n    languageConfig: state.otp.config.language,\n    timeFormat: coreUtils.time.getTimeFormat(state.otp.config),\n    tripData: state.otp.transitIndex.trips[viewedTrip.tripId],\n    viewedTrip\n  }\n}\n\nconst mapDispatchToProps = {\n  setViewedTrip,\n  findTrip,\n  setLocation\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TripViewer)\n"]}