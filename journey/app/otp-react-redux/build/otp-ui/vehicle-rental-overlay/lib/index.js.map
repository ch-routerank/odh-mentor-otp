{"version":3,"sources":["index.js"],"names":["Object","defineProperty","exports","value","default","_leaflet","require","_lodash","_interopRequireDefault","BaseMapStyled","_interopRequireWildcard","_itinerary","_types","_fromToLocationPicker","_propTypes","_react","_server","_reactLeaflet","_bikeIcons","Styled","_getRequireWildcardCache","WeakMap","cache","obj","__esModule","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_defineProperty","enumerable","configurable","writable","getStationMarkerByColor","color","divIcon","className","iconSize","popupAnchor","html","renderToStaticMarkup","createElement","StationMarker","VehicleRentalOverlay","MapLayer","constructor","args","station","stationIsHub","configCompanies","getStationName","setLocation","props","stationName","location","lat","y","lon","x","name","Popup","MapOverlayPopup","PopupTitle","PopupRow","bikesAvailable","spacesAvailable","symbolDef","strokeColor","fillColor","isFloatingBike","dockStrokeColor","CircleMarker","id","center","fillOpacity","radius","pixels","weight","renderPopupForStation","icon","floatingBikeIcon","pctFull","i","Math","round","hubIcons","Marker","position","markerIcon","mapSymbols","renderStationAsMarker","zoom","leaflet","map","getZoom","length","minZoom","maxZoom","type","renderStationAsCircle","renderStationAsHubAndFloatingBike","createLeafletElement","updateLeafletElement","startRefreshing","refreshVehicles","refreshTimer","setInterval","stopRefreshing","clearInterval","componentDidMount","companies","visible","console","warn","componentWillUnmount","componentDidUpdate","prevProps","render","stations","filteredStations","filter","networks","includes","FeatureGroup","renderStation","arrayOf","companyType","isRequired","string","func","vehicleRentalMapOverlaySymbolsType","stationType","bool","number","defaultProps","stationNetworks","getCompaniesLabelFromNetworks","isFloatingCar","isFloatingVehicle","_default","withLeaflet"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _leaflet = require(\"leaflet\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash.memoize\"));\n\nvar BaseMapStyled = _interopRequireWildcard(require(\"@opentripplanner/base-map/lib/styled\"));\n\nvar _itinerary = require(\"@opentripplanner/core-utils/lib/itinerary\");\n\nvar _types = require(\"@opentripplanner/core-utils/lib/types\");\n\nvar _fromToLocationPicker = _interopRequireDefault(require(\"@opentripplanner/from-to-location-picker\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _server = _interopRequireDefault(require(\"react-dom/server\"));\n\nvar _reactLeaflet = require(\"react-leaflet\");\n\nvar _bikeIcons = require(\"./bike-icons\");\n\nvar Styled = _interopRequireWildcard(require(\"./styled\"));\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst getStationMarkerByColor = (0, _lodash.default)(color => (0, _leaflet.divIcon)({\n  className: \"\",\n  iconSize: [11, 16],\n  popupAnchor: [0, -6],\n  html: _server.default.renderToStaticMarkup( /*#__PURE__*/_react.default.createElement(Styled.StationMarker, {\n    color: color\n  }))\n}));\n/**\n * This vehicle rental overlay can be used to render vehicle rentals of various\n * types. This layer can be configured to show different styles of markers at\n * different zoom levels.\n */\n\nclass VehicleRentalOverlay extends _reactLeaflet.MapLayer {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"renderPopupForStation\", (station, stationIsHub = false) => {\n      const {\n        configCompanies,\n        getStationName,\n        setLocation\n      } = this.props;\n      const stationName = getStationName(configCompanies, station);\n      const location = {\n        lat: station.y,\n        lon: station.x,\n        name: stationName\n      };\n      return /*#__PURE__*/_react.default.createElement(_reactLeaflet.Popup, null, /*#__PURE__*/_react.default.createElement(BaseMapStyled.MapOverlayPopup, null, /*#__PURE__*/_react.default.createElement(BaseMapStyled.PopupTitle, null, stationName), stationIsHub && /*#__PURE__*/_react.default.createElement(BaseMapStyled.PopupRow, null, /*#__PURE__*/_react.default.createElement(\"div\", null, \"Available bikes: \", station.bikesAvailable), /*#__PURE__*/_react.default.createElement(\"div\", null, \"Available docks: \", station.spacesAvailable)), /*#__PURE__*/_react.default.createElement(BaseMapStyled.PopupRow, null, /*#__PURE__*/_react.default.createElement(\"b\", null, \"$_travel_$\"), /*#__PURE__*/_react.default.createElement(_fromToLocationPicker.default, {\n        location: location,\n        setLocation: setLocation\n      }))));\n    });\n\n    _defineProperty(this, \"renderStationAsCircle\", (station, symbolDef) => {\n      let strokeColor = symbolDef.strokeColor || symbolDef.fillColor;\n\n      if (!station.isFloatingBike) {\n        strokeColor = symbolDef.dockStrokeColor || strokeColor;\n      }\n\n      return /*#__PURE__*/_react.default.createElement(_reactLeaflet.CircleMarker, {\n        key: station.id,\n        center: [station.y, station.x],\n        color: strokeColor,\n        fillColor: symbolDef.fillColor,\n        fillOpacity: 1,\n        radius: symbolDef.pixels - (station.isFloatingBike ? 1 : 0),\n        weight: 1\n      }, this.renderPopupForStation(station));\n    });\n\n    _defineProperty(this, \"renderStationAsHubAndFloatingBike\", station => {\n      let icon;\n\n      if (station.isFloatingBike) {\n        icon = _bikeIcons.floatingBikeIcon;\n      } else {\n        const pctFull = station.bikesAvailable / (station.bikesAvailable + station.spacesAvailable);\n        const i = Math.round(pctFull * 9);\n        icon = _bikeIcons.hubIcons[i];\n      }\n\n      return /*#__PURE__*/_react.default.createElement(_reactLeaflet.Marker, {\n        icon: icon,\n        key: station.id,\n        position: [station.y, station.x]\n      }, this.renderPopupForStation(station, !station.isFloatingBike));\n    });\n\n    _defineProperty(this, \"renderStationAsMarker\", (station, symbolDef) => {\n      const color = symbolDef && symbolDef.fillColor ? symbolDef.fillColor : \"gray\";\n      const markerIcon = getStationMarkerByColor(color);\n      return /*#__PURE__*/_react.default.createElement(_reactLeaflet.Marker, {\n        icon: markerIcon,\n        key: station.id,\n        position: [station.y, station.x]\n      }, this.renderPopupForStation(station));\n    });\n\n    _defineProperty(this, \"renderStation\", station => {\n      // render the station according to any map symbol configuration\n      const {\n        mapSymbols\n      } = this.props; // no config set, just render a default marker\n\n      if (!mapSymbols) return this.renderStationAsMarker(station); // get zoom to check which symbol to render\n\n      const zoom = this.props.leaflet.map.getZoom();\n\n      for (let i = 0; i < mapSymbols.length; i++) {\n        const symbolDef = mapSymbols[i];\n\n        if (symbolDef.minZoom <= zoom && symbolDef.maxZoom >= zoom) {\n          switch (symbolDef.type) {\n            case \"circle\":\n              return this.renderStationAsCircle(station, symbolDef);\n\n            case \"hubAndFloatingBike\":\n              return this.renderStationAsHubAndFloatingBike(station);\n\n            default:\n              return this.renderStationAsMarker(station, symbolDef);\n          }\n        }\n      } // no matching symbol definition, render default marker\n\n\n      return this.renderStationAsMarker(station);\n    });\n  }\n\n  createLeafletElement() {}\n\n  updateLeafletElement() {}\n\n  startRefreshing() {\n    const {\n      refreshVehicles\n    } = this.props; // Create the timer only if refreshVehicles is a valid function.\n\n    if (typeof refreshVehicles === \"function\") {\n      // initial station retrieval\n      refreshVehicles(); // set up timer to refresh stations periodically\n\n      this.refreshTimer = setInterval(() => {\n        refreshVehicles();\n      }, 30000); // defaults to every 30 sec. TODO: make this configurable?\n    }\n  }\n\n  stopRefreshing() {\n    if (this.refreshTimer) clearInterval(this.refreshTimer);\n  }\n\n  componentDidMount() {\n    const {\n      companies,\n      mapSymbols,\n      name,\n      visible\n    } = this.props;\n    if (visible) this.startRefreshing();\n    if (!mapSymbols) console.warn(`No map symbols provided for layer ${name}`, companies);\n  }\n\n  componentWillUnmount() {\n    this.stopRefreshing();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (!prevProps.visible && this.props.visible) {\n      this.startRefreshing();\n    } else if (prevProps.visible && !this.props.visible) {\n      this.stopRefreshing();\n    }\n  }\n  /**\n   * Render some popup html for a station. This contains custom logic for\n   * displaying rental vehicles in the TriMet MOD website that might not be\n   * applicable to other regions.\n   */\n\n\n  render() {\n    const {\n      stations,\n      companies\n    } = this.props;\n    let filteredStations = stations;\n\n    if (companies) {\n      filteredStations = stations.filter(station => station.networks.filter(value => companies.includes(value)).length > 0);\n    }\n\n    if (!filteredStations || filteredStations.length === 0) {\n      return /*#__PURE__*/_react.default.createElement(_reactLeaflet.FeatureGroup, null);\n    }\n\n    return /*#__PURE__*/_react.default.createElement(_reactLeaflet.FeatureGroup, null, filteredStations.map(this.renderStation));\n  }\n\n}\n\nVehicleRentalOverlay.props = {\n  /**\n   * The entire companies config array.\n   */\n  configCompanies: _propTypes.default.arrayOf(_types.companyType.isRequired).isRequired,\n\n  /**\n   * A list of companies that are applicable to just this instance of the\n   * overlay.\n   */\n  companies: _propTypes.default.arrayOf(_propTypes.default.string.isRequired),\n\n  /**\n   * An optional custom function to create a string name of a particular vehicle\n   * rental station. This function takes two arguments of the configCompanies\n   * prop and a vehicle rental station. The function must return a string.\n   */\n  getStationName: _propTypes.default.func,\n\n  /**\n   * A configuration of what map markers or symbols to show at various zoom\n   * levels.\n   */\n  mapSymbols: _types.vehicleRentalMapOverlaySymbolsType,\n\n  /**\n   * If specified, a function that will be triggered every 30 seconds whenever this layer is\n   * visible.\n   */\n  refreshVehicles: _propTypes.default.func,\n\n  /**\n   * A callback for when a user clicks on setting this stop as either the from\n   * or to location of a new search.\n   *\n   * This will be dispatched with the following argument:\n   *\n   * ```js\n   *  {\n   *    location: {\n   *      lat: number,\n   *      lon: number,\n   *      name: string\n   *    },\n   *    locationType: \"from\" or \"to\"\n   *  }\n   * ```\n   */\n  setLocation: _propTypes.default.func.isRequired,\n\n  /**\n   * A list of the vehicle rental stations specific to this overlay instance.\n   */\n  stations: _propTypes.default.arrayOf(_types.stationType),\n\n  /**\n   * Whether the overlay is currently visible.\n   */\n  visible: _propTypes.default.bool,\n\n  /**\n   * The current map zoom level.\n   */\n  zoom: _propTypes.default.number.isRequired\n};\nVehicleRentalOverlay.defaultProps = {\n  getStationName: (configCompanies, station) => {\n    const stationNetworks = (0, _itinerary.getCompaniesLabelFromNetworks)(station.networks, configCompanies);\n    let stationName = station.name || station.id;\n\n    if (station.isFloatingBike) {\n      stationName = `Free-floating bike: ${stationName}`;\n    } else if (station.isFloatingCar) {\n      stationName = `${stationNetworks} ${stationName}`;\n    } else if (station.isFloatingVehicle) {\n      // assumes that all floating vehicles are E-scooters\n      stationName = `${stationNetworks} E-scooter`;\n    }\n\n    return stationName;\n  },\n  mapSymbols: null,\n  refreshVehicles: null,\n  stations: [],\n  visible: false\n};\n\nvar _default = (0, _reactLeaflet.withLeaflet)(VehicleRentalOverlay);\n\nexports.default = _default;"]}