{"version":3,"sources":["realtime-annotation.js"],"names":["RealtimeAnnotation","props","componentClass","realtimeEffects","toggleRealtime","useRealtime","filteredRoutes","normalRoutes","filter","routeId","index","self","indexOf","innerContent","coreUtils","time","formatDuration","normalDuration","map","route","idx","length","maxWidth","Component","PropTypes","object","func","bool"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAEqBA,kB;;;;;;;;;;;;;6BAOT;AAAA,wBAMJ,KAAKC,KAND;AAAA,UAENC,cAFM,eAENA,cAFM;AAAA,UAGNC,eAHM,eAGNA,eAHM;AAAA,UAINC,cAJM,eAINA,cAJM;AAAA,UAKNC,WALM,eAKNA,WALM,EAOR;;AACA,UAAMC,cAAc,GAAGH,eAAe,CAACI,YAAhB,CACpBC,MADoB,CACb,UAACC,OAAD,EAAUC,KAAV,EAAiBC,IAAjB;AAAA,eAA0BA,IAAI,CAACC,OAAL,CAAaH,OAAb,MAA0BC,KAApD;AAAA,OADa,CAAvB,CARQ,CAUR;AACA;;AACA,UAAMG,YAAY,gBAAG;AAAK,QAAA,SAAS,EAAC;AAAf,sBACnB;AAAK,QAAA,SAAS,EAAC;AAAf,sBACE,sDACE;AAAG,QAAA,SAAS,EAAC;AAAb,QADF,oBADF,eAIE,wCACGR,WAAW,gBACR;AAAM,QAAA,SAAS,EAAC;AAAhB,+HAE2D,GAF3D,eAGA,wCAAIS,mBAAUC,IAAV,CAAeC,cAAf,CAA8Bb,eAAe,CAACc,cAA9C,CAAJ,MAHA,iCAI4B,GAJ5B,EAKCX,cAAc,CACZY,GADF,CACM,UAACC,KAAD,EAAQC,GAAR;AAAA,4BACH;AAAM,UAAA,GAAG,EAAEA;AAAX,wBACE,wCAAID,KAAJ,CADF,EAEGb,cAAc,CAACe,MAAf,GAAwB,CAAxB,GAA4BD,GAA5B,IAAmC,IAFtC,CADG;AAAA,OADN,CALD,MADQ,gBAeR;AAAM,QAAA,SAAS,EAAC;AAAhB,uIAhBN,CAJF,eA0BE,uDACE,6BAAC,sBAAD;AACE,QAAA,KAAK,EAAElB,cAAc,KAAK,SAD5B,CACuC;AADvC;AAEE,QAAA,SAAS,EAAC,iBAFZ;AAGE,QAAA,OAAO,EAAEE;AAHX,SAKGC,WAAW,qBALd,oBADF,CA1BF,CADmB,CAArB;;AAuCA,UAAIH,cAAc,KAAK,SAAvB,EAAkC;AAChC,4BAAO,6BAAC,8BAAD;AACL,UAAA,OAAO,EAAC,OADH;AAEL,UAAA,SAAS,EAAC,QAFL,CAGL;AACA;AAJK;AAKL,UAAA,OAAO,eACL,6BAAC,uBAAD;AAAS,YAAA,KAAK,EAAE;AAACoB,cAAAA,QAAQ,EAAE;AAAX,aAAhB;AAAqC,YAAA,EAAE,EAAC;AAAxC,aACGT,YADH;AANG,wBAUL,6BAAC,sBAAD;AAAQ,UAAA,OAAO,EAAC;AAAhB,wBAAuB;AAAG,UAAA,SAAS,EAAC;AAAb,UAAvB,CAVK,CAAP;AAYD,OAbD,MAaO;AACL,eAAOA,YAAP;AACD;AACF;;;;EA1E6CU,gB;;;;gBAA3BvB,kB,eACA;AACjBG,EAAAA,eAAe,EAAEqB,mBAAUC,MADV;AAEjBrB,EAAAA,cAAc,EAAEoB,mBAAUE,IAFT;AAGjBrB,EAAAA,WAAW,EAAEmB,mBAAUG;AAHN,C","sourcesContent":["import coreUtils from '@opentripplanner/core-utils'\nimport PropTypes from 'prop-types'\nimport React, { Component } from 'react'\nimport { Button, OverlayTrigger, Popover } from 'react-bootstrap'\n\nexport default class RealtimeAnnotation extends Component {\n  static propTypes = {\n    realtimeEffects: PropTypes.object,\n    toggleRealtime: PropTypes.func,\n    useRealtime: PropTypes.bool\n  }\n\n  render () {\n    const {\n      componentClass,\n      realtimeEffects,\n      toggleRealtime,\n      useRealtime\n    } = this.props\n    // Keep only the unique route IDs (so that duplicates are not listed).\n    const filteredRoutes = realtimeEffects.normalRoutes\n      .filter((routeId, index, self) => self.indexOf(routeId) === index)\n    // FIXME: there are some weird css things happening in desktop vs. mobile,\n    // so I removed the divs with classNames and opted for h4 and p for now\n    const innerContent = <div className='realtime-alert'>\n      <div className='content'>\n        <h3>\n          <i className='fa fa-exclamation-circle' /> Service update\n        </h3>\n        <p>\n          {useRealtime\n            ? <span className='small'>\n              Your trip results have been adjusted based on real-time\n              information. Under normal conditions, this trip would take{' '}\n              <b>{coreUtils.time.formatDuration(realtimeEffects.normalDuration)} </b>\n              using the following routes:{' '}\n              {filteredRoutes\n                .map((route, idx) => (\n                  <span key={idx}>\n                    <b>{route}</b>\n                    {filteredRoutes.length - 1 > idx && ', '}\n                  </span>\n                ))\n              }.\n            </span>\n            : <span className='small'>\n              Your trip results are currently being affected by service delays.\n              These delays do not factor into travel times shown below.\n            </span>\n          }\n        </p>\n        <div>\n          <Button\n            block={componentClass === 'popover'} // display as block in popover\n            className='toggle-realtime'\n            onClick={toggleRealtime}\n          >\n            {useRealtime ? `Ignore` : `Apply`} service delays\n          </Button>\n        </div>\n      </div>\n    </div>\n\n    if (componentClass === 'popover') {\n      return <OverlayTrigger\n        trigger='click'\n        placement='bottom'\n        // container={this}\n        // containerPadding={40}\n        overlay={\n          <Popover style={{maxWidth: '300px'}} id='popover-positioned-bottom'>\n            {innerContent}\n          </Popover>\n        }>\n        <Button bsStyle='link'><i className='fa fa-2x fa-exclamation-circle' /></Button>\n      </OverlayTrigger>\n    } else {\n      return innerContent\n    }\n  }\n}\n"]}